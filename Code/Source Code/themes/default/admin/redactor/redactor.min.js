/*! Story_admin_theme - v2.0.5 | (c) Arpad Olasz | Proprietary. */
if(!RedactorPlugins)var RedactorPlugins={};if(function(a){RedactorPlugins.definedlinks=function(){return{init:function(){this.opts.definedLinks&&this.modal.addCallback("link",a.proxy(this.definedlinks.load,this))},load:function(){var b=a('<select id="redactor-defined-links" />');a("#redactor-modal-link-insert").prepend(b),this.definedlinks.storage={},a.getJSON(this.opts.definedLinks,a.proxy(function(c){a.each(c,a.proxy(function(c,d){this.definedlinks.storage[c]=d,b.append(a("<option>").val(c).html(d.name))},this)),b.on("change",a.proxy(this.definedlinks.select,this))},this))},select:function(b){var c=a(b.target).val(),d="",e="";0!==c&&(d=this.definedlinks.storage[c].name,e=this.definedlinks.storage[c].url),a("#redactor-link-url").val(e);var f=a("#redactor-link-url-text");""===f.val()&&f.val(d)}}}}(jQuery),!RedactorPlugins)var RedactorPlugins={};if(function(a){RedactorPlugins.filemanager=function(){return{init:function(){this.opts.fileManagerJson&&this.modal.addCallback("file",this.filemanager.load)},load:function(){var b=this.modal.getModal();this.modal.createTabber(b),this.modal.addTab(1,"Upload","active"),this.modal.addTab(2,"Choose"),a("#redactor-modal-file-upload-box").addClass("redactor-tab redactor-tab1");var c=a('<div id="redactor-file-manager-box" style="overflow: auto; height: 300px;" class="redactor-tab redactor-tab2">').hide();b.append(c),a.ajax({dataType:"json",cache:!1,url:this.opts.fileManagerJson,success:a.proxy(function(b){var c=a('<ul id="redactor-modal-list">');a.each(b,a.proxy(function(b,d){var e=a('<a href="#" title="'+d.title+'" rel="'+d.link+'" class="redactor-file-manager-link">'+d.title+' <span style="font-size: 11px; color: #888;">'+d.name+'</span> <span style="position: absolute; right: 10px; font-size: 11px; color: #888;">('+d.size+")</span></a>"),f=a("<li />");e.on("click",a.proxy(this.filemanager.insert,this)),f.append(e),c.append(f)},this)),a("#redactor-file-manager-box").append(c)},this)})},insert:function(b){b.preventDefault();var c=a(b.target).closest(".redactor-file-manager-link");this.file.insert('<a href="'+c.attr("rel")+'">'+c.attr("title")+"</a>")}}}}(jQuery),!RedactorPlugins)var RedactorPlugins={};if(function(a){RedactorPlugins.fontcolor=function(){return{init:function(){for(var a=["#ffffff","#000000","#eeece1","#1f497d","#4f81bd","#c0504d","#9bbb59","#8064a2","#4bacc6","#f79646","#ffff00","#f2f2f2","#7f7f7f","#ddd9c3","#c6d9f0","#dbe5f1","#f2dcdb","#ebf1dd","#e5e0ec","#dbeef3","#fdeada","#fff2ca","#d8d8d8","#595959","#c4bd97","#8db3e2","#b8cce4","#e5b9b7","#d7e3bc","#ccc1d9","#b7dde8","#fbd5b5","#ffe694","#bfbfbf","#3f3f3f","#938953","#548dd4","#95b3d7","#d99694","#c3d69b","#b2a2c7","#b7dde8","#fac08f","#f2c314","#a5a5a5","#262626","#494429","#17365d","#366092","#953734","#76923c","#5f497a","#92cddc","#e36c09","#c09100","#7f7f7f","#0c0c0c","#1d1b10","#0f243e","#244061","#632423","#4f6128","#3f3151","#31859b","#974806","#7f6000"],b=["fontcolor","backcolor"],c=0;2>c;c++){var d=b[c],e=this.button.add(d,this.lang.get(d)),f=this.button.addDropdown(e);f.width(242),this.fontcolor.buildPicker(f,d,a)}},buildPicker:function(b,c,d){for(var e="backcolor"==c?"background-color":"color",f=d.length,g=this,h=function(b){b.preventDefault(),g.fontcolor.set(a(this).data("rule"),a(this).attr("rel"))},i=0;f>i;i++){var j=d[i],k=a('<a rel="'+j+'" data-rule="'+e+'" href="#" style="float: left; font-size: 0; border: 2px solid #fff; padding: 0; margin: 0; width: 22px; height: 22px;"></a>');k.css("background-color",j),k.on("click",h),b.append(k)}var l=a('<a href="#" style="display: block; clear: both; padding: 5px; font-size: 12px; line-height: 1;"></a>').html(this.lang.get("none"));l.on("click",a.proxy(function(a){a.preventDefault(),this.fontcolor.remove(e)},this)),b.append(l)},set:function(a,b){this.inline.format("span","style",a+": "+b+";")},remove:function(a){this.inline.removeStyleRule(a)}}}}(jQuery),!RedactorPlugins)var RedactorPlugins={};if(function(a){RedactorPlugins.fontfamily=function(){return{init:function(){var b=["Arial","Helvetica","Georgia","Times New Roman","Monospace"],c=this,d={};a.each(b,function(a,b){d["s"+a]={title:b,func:function(){c.fontfamily.set(b)}}}),d.remove={title:"Remove Font Family",func:c.fontfamily.reset};var e=this.button.add("fontfamily","Change Font Family");this.button.addDropdown(e,d)},set:function(a){this.inline.format("span","style","font-family:"+a+";")},reset:function(){this.inline.removeStyleRule("font-family")}}}}(jQuery),!RedactorPlugins)var RedactorPlugins={};if(function(a){RedactorPlugins.fontsize=function(){return{init:function(){var b=[10,11,12,14,16,18,20,24,28,30],c=this,d={};a.each(b,function(a,b){d["s"+a]={title:b+"px",func:function(){c.fontsize.set(b)}}}),d.remove={title:"Remove Font Size",func:c.fontsize.reset};var e=this.button.add("fontsize","Change Font Size");this.button.addDropdown(e,d)},set:function(a){this.inline.format("span","style","font-size: "+a+"px;")},reset:function(){this.inline.removeStyleRule("font-size")}}}}(jQuery),!RedactorPlugins)var RedactorPlugins={};if(function(a){RedactorPlugins.imagemanager=function(){return{init:function(){this.opts.imageManagerJson&&this.modal.addCallback("image",this.imagemanager.load)},load:function(){var b=this.modal.getModal();this.modal.createTabber(b),this.modal.addTab(1,"Upload","active"),this.modal.addTab(2,"Choose"),a("#redactor-modal-image-droparea").addClass("redactor-tab redactor-tab1");var c=a('<div id="redactor-image-manager-box" style="overflow: auto; height: 300px;" class="redactor-tab redactor-tab2">').hide();b.append(c),a.ajax({dataType:"json",cache:!1,url:this.opts.imageManagerJson,success:a.proxy(function(b){a.each(b,a.proxy(function(b,c){var d="";"undefined"!=typeof c.title&&(d=c.title);var e=a('<img src="'+c.thumb+'" rel="'+c.image+'" title="'+d+'" style="width: 95px;cursor: pointer;" class="generic-img m--"/>');a("#redactor-image-manager-box").append(e),a(e).click(a.proxy(this.imagemanager.insert,this))},this))},this)})},insert:function(b){this.image.insert('<img src="'+a(b.target).attr("rel")+'" alt="'+a(b.target).attr("title")+'">')}}}}(jQuery),!RedactorPlugins)var RedactorPlugins={};if(function(a){RedactorPlugins.table=function(){return{getTemplate:function(){return String()+'<section id="redactor-modal-table-insert"><label>'+this.lang.get("rows")+'</label><input type="text" size="5" value="2" id="redactor-table-rows" /><label>'+this.lang.get("columns")+'</label><input type="text" size="5" value="3" id="redactor-table-columns" /></section>'},init:function(){var a={};a.insert_table={title:this.lang.get("insert_table"),func:this.table.show},a.insert_row_above={title:this.lang.get("insert_row_above"),func:this.table.addRowAbove},a.insert_row_below={title:this.lang.get("insert_row_below"),func:this.table.addRowBelow},a.insert_column_left={title:this.lang.get("insert_column_left"),func:this.table.addColumnLeft},a.insert_column_right={title:this.lang.get("insert_column_right"),func:this.table.addColumnRight},a.add_head={title:this.lang.get("add_head"),func:this.table.addHead},a.delete_head={title:this.lang.get("delete_head"),func:this.table.deleteHead},a.delete_column={title:this.lang.get("delete_column"),func:this.table.deleteColumn},a.delete_row={title:this.lang.get("delete_row"),func:this.table.deleteRow},a.delete_table={title:this.lang.get("delete_table"),func:this.table.deleteTable},this.observe.addButton("td","table"),this.observe.addButton("th","table");var b=this.button.addBefore("link","table",this.lang.get("table"));this.button.addDropdown(b,a)},show:function(){this.modal.addTemplate("table",this.table.getTemplate()),this.modal.load("table",this.lang.get("insert_table"),300),this.modal.createCancelButton();var b=this.modal.createActionButton(this.lang.get("insert"));b.on("click",this.table.insert),this.selection.save(),this.modal.show(),a("#redactor-table-rows").focus()},insert:function(){var b,c,d,e,f=a("#redactor-table-rows").val(),g=a("#redactor-table-columns").val(),h=a("<div>"),i=Math.floor(99999*Math.random()),j=a('<table id="table'+i+'"><tbody></tbody></table>');for(b=0;f>b;b++){for(c=a("<tr>"),d=0;g>d;d++)e=a("<td>"+this.opts.invisibleSpace+"</td>"),0===b&&0===d&&e.append(this.selection.getMarker()),a(c).append(e);j.append(c)}h.append(j);var k=h.html();if(this.modal.close(),this.selection.restore(),!this.table.getTable()){this.buffer.set();var l=this.selection.getBlock()||this.selection.getCurrent();l&&"BODY"!=l.tagName?("LI"==l.tagName&&(l=a(l).closest("ul, ol")),a(l).after(k)):this.insert.html(k),this.selection.restore();var m=this.$editor.find("#table"+i);if(!this.opts.linebreaks&&(this.utils.browser("mozilla")||this.utils.browser("msie"))){var n=m.next();0===n.length&&m.after(this.opts.emptyHtml)}this.observe.buttons(),m.find("span.redactor-selection-marker").remove(),m.removeAttr("id"),this.code.sync(),this.core.setCallback("insertedTable",m)}},getTable:function(){var b=a(this.selection.getParent()).closest("table");return this.utils.isRedactorParent(b)?0===b.size()?!1:b:!1},restoreAfterDelete:function(a){this.selection.restore(),a.find("span.redactor-selection-marker").remove(),this.code.sync()},deleteTable:function(){var a=this.table.getTable();if(a){this.buffer.set();var b=a.next();this.opts.linebreaks||0===b.length?this.caret.setAfter(a):this.caret.setStart(b),a.remove(),this.code.sync()}},deleteRow:function(){var b=this.table.getTable();if(b){var c=a(this.selection.getCurrent());this.buffer.set();var d=c.closest("tr"),e=d.prev().length?d.prev():d.next();if(e.length){var f=e.children("td, th").first();f.length&&f.prepend(this.selection.getMarker())}d.remove(),this.table.restoreAfterDelete(b)}},deleteColumn:function(){var b=this.table.getTable();if(b){this.buffer.set();var c=a(this.selection.getCurrent()),d=c.closest("td, th"),e=d[0].cellIndex;b.find("tr").each(a.proxy(function(b,c){var d=a(c),f=0>e-1?e+1:e-1;0===b&&d.find("td, th").eq(f).prepend(this.selection.getMarker()),d.find("td, th").eq(e).remove()},this)),this.table.restoreAfterDelete(b)}},addHead:function(){var b=this.table.getTable();if(b){if(this.buffer.set(),0!==b.find("thead").size())return void this.table.deleteHead();var c=b.find("tr").first().clone();c.find("td").replaceWith(a.proxy(function(){return a("<th>").html(this.opts.invisibleSpace)},this)),$thead=a("<thead></thead>").append(c),b.prepend($thead),this.code.sync()}},deleteHead:function(){var a=this.table.getTable();if(a){var b=a.find("thead");0!==b.size()&&(this.buffer.set(),b.remove(),this.code.sync())}},addRowAbove:function(){this.table.addRow("before")},addRowBelow:function(){this.table.addRow("after")},addColumnLeft:function(){this.table.addColumn("before")},addColumnRight:function(){this.table.addColumn("after")},addRow:function(b){var c=this.table.getTable();if(c){this.buffer.set();var d=a(this.selection.getCurrent()),e=d.closest("tr"),f=e.clone();f.find("th").replaceWith(function(){var b=a("<td>");return b[0].attributes=this.attributes,b.append(a(this).contents())}),f.find("td").html(this.opts.invisibleSpace),"after"==b?e.after(f):e.before(f),this.code.sync()}},addColumn:function(b){var c=this.table.getTable();if(c){var d=0,e=a(this.selection.getCurrent());this.buffer.set();var f=e.closest("tr"),g=e.closest("td, th");f.find("td, th").each(a.proxy(function(b,c){a(c)[0]===g[0]&&(d=b)},this)),c.find("tr").each(a.proxy(function(c,e){var f=a(e).find("td, th").eq(d),g=f.clone();g.html(this.opts.invisibleSpace),"after"==b?f.after(g):f.before(g)},this)),this.code.sync()}}}}}(jQuery),!RedactorPlugins)var RedactorPlugins={};if(function(a){RedactorPlugins.video=function(){return{reUrlYoutube:/https?:\/\/(?:[0-9A-Z-]+\.)?(?:youtu\.be\/|youtube\.com\S*[^\w\-\s])([\w\-]{11})(?=[^\w\-]|$)(?![?=&+%\w.-]*(?:['"][^<>]*>|<\/a>))[?=&+%\w.-]*/gi,reUrlVimeo:/https?:\/\/(www\.)?vimeo.com\/(\d+)($|\/)/,getTemplate:function(){return String()+'<section id="redactor-modal-video-insert"><label>'+this.lang.get("video_html_code")+'</label><textarea id="redactor-insert-video-area" style="height: 160px;"></textarea></section>'},init:function(){var a=this.button.addAfter("image","video",this.lang.get("video"));this.button.addCallback(a,this.video.show)},show:function(){this.modal.addTemplate("video",this.video.getTemplate()),this.modal.load("video",this.lang.get("video"),700),this.modal.createCancelButton();var b=this.modal.createActionButton(this.lang.get("insert"));b.on("click",this.video.insert),this.selection.save(),this.modal.show(),a("#redactor-insert-video-area").focus()},insert:function(){var b=a("#redactor-insert-video-area").val();if(!b.match(/<iframe|<video/gi)){b=this.clean.stripTags(b);var c='<iframe style="width: 500px; height: 281px;" src="',d='" frameborder="0" allowfullscreen></iframe>';b.match(this.video.reUrlYoutube)?b=b.replace(this.video.reUrlYoutube,c+"//www.youtube.com/embed/$1"+d):b.match(this.video.reUrlVimeo)&&(b=b.replace(this.video.reUrlVimeo,c+"//player.vimeo.com/video/$2"+d))}this.selection.restore(),this.modal.close();var e=this.selection.getBlock()||this.selection.getCurrent();e?a(e).after(b):this.insert.html(b),this.code.sync()}}}}(jQuery),!RedactorPlugins)var RedactorPlugins={};RedactorPlugins.snippets=function(){return{init:function(){if(this.opts.snippetManagerJson){this.modal.addTemplate("snippets",$('<section id="redactor-snippet-manager-box"><ul id="redactor-modal-list"></section>'));var a=this.button.add("clips","Snippets");this.button.addCallback(a,this.snippets.show)}},show:function(){this.modal.load("snippets","Insert Clips",700),this.modal.createCancelButton(),this.selection.save(),$.ajax({dataType:"json",cache:!1,url:this.opts.snippetManagerJson,success:$.proxy(function(a){var b=$("ul",this.modal.getTemplate("snippets")).empty();$.each(a,$.proxy(function(a,c){var d=$("<li>"),e=$('<a href="#" class="redactor-clip-link">').text(c.title);e.click($.proxy(this.snippets.insert,this));var f=$('<div class="redactor-clip">').hide().html(c.content);d.append(e),d.append(f),b.append(d)},this))},this)}),this.modal.show()},insert:function(a){this.insert.html($(a.target).next().html(),!1),this.modal.close()}}},function(){"use strict";"undefined"==typeof window.ws&&(window.ws={}),window.ws.redactor=jQuery.extend({indentValue:21,minHeight:210,plugins:["snippets","definedlinks","filemanager","fontcolor","fontfamily","fontsize","imagemanager","table","video"],imageUploadCallback:function(){$.fn.wsNotify&&$(".notifications > ol").wsNotify("show",{content:"Image uploaded.",title:"Success",icon:"info-circle",type:"positive"})},imageUploadErrorCallback:function(a){$.fn.wsNotify?$(".notifications > ol").wsNotify("show",{content:a.message,title:"Error",icon:"exclamation-circle",type:"negative"}):alert(a.message)},fileUploadCallback:function(){$.fn.wsNotify&&$(".notifications > ol").wsNotify("show",{content:"File uploaded.",title:"Success",icon:"info-circle",type:"positive"})},fileUploadErrorCallback:function(a){$.fn.wsNotify?$(".notifications > ol").wsNotify("show",{content:a.message,title:"Error",icon:"exclamation-circle",type:"negative"}):alert(a.message)},formatting:["p","h1","h2","h3","h4","h5","blockquote"]},window.ws.redactor);var a=function(){var a="redactor-box--focused",b="redactor",c={focusCallback:function(){this.$box.addClass(a)},blurCallback:function(){this.$box.removeClass(a)}};return $.each($(this).data(),function(a,d){if(a.substr(0,b.length)===b.toLowerCase()){var e=a.substr(b.length,1).toLowerCase()+a.substr(b.length+1);c[e]=d}}),jQuery.extend(window.ws.redactor,c)};$("textarea.text-input--redactor").each(function(){var b=a.apply(this);$(this).hasClass("text-input--redactor-frontend")&&(b.formattingAdd=[{tag:"p",title:"Content hero","class":"content-hero"},{tag:"p",title:"Secondary hero","class":"content-hero content-hero--secondary"},{tag:"span",title:"Lozenge","class":"loz"},{tag:"span",title:"Positive Lozenge","class":"loz-positive"},{tag:"span",title:"Alert Lozenge","class":"loz-alert"},{tag:"span",title:"Negative Lozenge","class":"loz-negative"}]),$(this).redactor(b)}),$(".tabs-content li").on("onTabOpen",function(a,b,c){var d=$(".toolbar .redactor-toolbar");d.length&&(d.hide(),$("#toolbar"+c.substr(3)).show(),$("#toolbar"+c.substr(3)+" ul.redactor-toolbar-external").show(),"function"==typeof window.setContentToolbarTopPadding&&window.setContentToolbarTopPadding())})}();